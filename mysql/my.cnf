# Copyright (c) 2016, Oracle and/or its affiliates. All rights reserved.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
#
# The MySQL  Server configuration file.
#
# For explanations see
# https://blog.wu06.com/2019/05/27/linux%E4%B8%8Bmysql%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6my.cnf%E8%AF%A6%E8%A7%A3/

[mysqld]

# 数据库默认字符集配置
# utf8mb4编码是utf8编码的超集，兼容utf8，并且能存储4字节的表情字符
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci

# 默认的数据库引擎
default-storage-engine = InnoDB

# 建议禁用符号链接，以防止各种安全风险；为此，取消这一行的注释
symbolic-links = 0

# sql模式设置
sql_mode = NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES 

# 不使用高速缓存区来存放主机名和IP地址的对应关系。
# skip-host-cache

# 禁止MySQL对外部连接进行DNS解析，使用这一选项可以消除MySQL进行DNS解析的时间。但需要注意，如果开启该选项， 则所有远程主机连接授权都要使用IP地址方式，否则MySQL将无法正常处理连接请求
# skip-name-resolve 

# 全局动态变量，默认3，范围：1～3
# 表示错误日志记录的信息，1：只记录error信息；2：记录error和warnings信息；3：记录error、warnings和普通的notes信息。
log_error_verbosity = 3

# 错误日志路径
log_error	= /logs/mysql_error.log 

# 指定是否开启慢查询日志. 慢查询是指消耗了比 “long_query_time” 定义的更多时间的查询.如果 log_long_format 被打开,那些没有使用索引的查询也会被记录.如果你经常增加新查询到已有的系统内的话. 一般来说这是一个好主意。
slow_query_log = 1

# 参数 log_output 指定了慢查询输出的格式，默认为 FILE，你可以将它设为 TABLE，然后就可以查询 mysql 架构下的 slow_log 表了
###log_output = TABLE

# 设定慢查询的阀值，超出次设定值的SQL即被记录到慢查询日志，缺省值为10s.所有的使用了比这个时间(以秒为单位)更多的查询会被认为是慢速查询.不要在这里使用”1″, 否则会导致所有的查询,甚至非常快的查询页被记录下来(由于MySQL 目前时间的精确度只能达到秒的级别)。
long_query_time =  3

# 在慢速日志中记录更多的信息.一般此项最好打开，打开此项会记录使得那些没有使用索引的查询也被作为到慢速查询附加到慢速日志里
# 打开了docker容器启动不了
###log_long_format

# 指定慢日志文件存放位置，可以为空，系统会给一个缺省的文件host_name_slow.log
#slow_query_log_file = /logs/mysql_slow_query.log 

# 将所有到达MySQL Server的SQL语句记录下来,默认关闭 
general_log = 1

# general_log路径
general_log_file =  /logs/mysql_general.log 


[mysql]

# auto-rehash
# 开启数据库tab补全

no-auto-rehash
# 关闭数据库tab补全

# 登录数据库后显示当前位置
prompt = "Welcome to Docker-MySQL [\d]> "

# 加载原本的其他设置
!includedir /etc/mysql/conf.d/
!includedir /etc/mysql/mysql.conf.d/
